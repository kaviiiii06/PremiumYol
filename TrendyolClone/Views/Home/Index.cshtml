@model List<TrendyolClone.Models.Urun>
@{
    ViewData["Title"] = "Ana Sayfa";
}

<!-- Kategori Daireleri -->
@if (ViewBag.Categories != null && ((List<TrendyolClone.Models.Kategori>)ViewBag.Categories).Any())
{
    var categories = (List<TrendyolClone.Models.Kategori>)ViewBag.Categories;
    var categoryIcons = new Dictionary<string, string>
    {
        { "Elektronik", "fas fa-laptop" },
        { "Giyim", "fas fa-tshirt" },
        { "Ev & Yaşam", "fas fa-home" },
        { "Spor", "fas fa-running" },
        { "Kozmetik", "fas fa-spa" },
        { "Kitap", "fas fa-book" },
        { "Oyuncak", "fas fa-gamepad" },
        { "Ayakkabı", "fas fa-shoe-prints" },
        { "Aksesuar", "fas fa-gem" },
        { "Mobilya", "fas fa-couch" }
    };
    
    var categoryGradients = new[]
    {
        "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
        "linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",
        "linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",
        "linear-gradient(135deg, #fa709a 0%, #fee140 100%)",
        "linear-gradient(135deg, #30cfd0 0%, #330867 100%)",
        "linear-gradient(135deg, #11998e 0%, #38ef7d 100%)",
        "linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)",
        "linear-gradient(135deg, #ff6b6b 0%, #ffd93d 100%)",
        "linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%)",
        "linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)"
    };
    
    <section class="mb-4">
        <div class="campaign-circles-wrapper">
            <button class="circle-nav-btn circle-nav-prev" onclick="scrollCategories(-1)">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div class="campaign-circles" id="categoryScroller">
                @for (int i = 0; i < categories.Count && i < 10; i++)
                {
                    var kategori = categories[i];
                    var gradient = categoryGradients[i % categoryGradients.Length];
                    var icon = categoryIcons.ContainsKey(kategori.Ad) ? categoryIcons[kategori.Ad] : "fas fa-tag";
                    
                    <div class="campaign-circle stagger-item">
                        <a asp-controller="Urun" asp-action="Index" asp-route-KategoriId="@kategori.Id" class="text-decoration-none">
                            <div class="circle-content" style="background: @gradient;">
                                <i class="@icon circle-icon"></i>
                                <span class="circle-text">@kategori.Ad</span>
                            </div>
                        </a>
                    </div>
                }
            </div>
            <button class="circle-nav-btn circle-nav-next" onclick="scrollCategories(1)">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </section>
}

<!-- Hero Slider -->
<section class="mb-4">
    <div id="heroCarousel" class="carousel slide main-slider" data-bs-ride="carousel" data-bs-interval="5000">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active"></button>
            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1"></button>
            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2"></button>
        </div>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <div class="slider-content" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <div class="container">
                        <div class="row align-items-center">
                            <div class="col-lg-7 text-white">
                                <span class="badge bg-white text-primary mb-3 px-3 py-2">
                                    <i class="fas fa-fire me-1"></i>Yeni Sezon
                                </span>
                                <h2 class="display-5 fw-bold mb-3">KARGO BEDAVA!</h2>
                                <p class="lead mb-4 opacity-90">Tüm ürünlerde %30'a varan indirim fırsatını kaçırmayın.</p>
                                <a asp-controller="Urun" asp-action="Index" class="btn btn-light btn-lg px-5">
                                    <i class="fas fa-shopping-bag me-2"></i>Alışverişe Başla
                                </a>
                            </div>
                            <div class="col-lg-5 text-center d-none d-lg-block">
                                <i class="fas fa-shopping-bag slider-icon text-white"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <div class="slider-content" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <div class="container">
                        <div class="row align-items-center">
                            <div class="col-lg-7 text-white">
                                <span class="badge bg-white text-danger mb-3 px-3 py-2">
                                    <i class="fas fa-percent me-1"></i>Süper Fırsat
                                </span>
                                <h2 class="display-5 fw-bold mb-3">SEPETTE %30 İNDİRİM</h2>
                                <p class="lead mb-4 opacity-90">Seçili ürünlerde özel indirim fırsatları sizi bekliyor.</p>
                                <a asp-controller="Urun" asp-action="Index" class="btn btn-light btn-lg px-5">
                                    <i class="fas fa-gift me-2"></i>Fırsatları Gör
                                </a>
                            </div>
                            <div class="col-lg-5 text-center d-none d-lg-block">
                                <i class="fas fa-gift slider-icon text-white"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <div class="slider-content" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
                    <div class="container">
                        <div class="row align-items-center">
                            <div class="col-lg-7 text-white">
                                <span class="badge bg-white text-success mb-3 px-3 py-2">
                                    <i class="fas fa-star me-1"></i>Premium
                                </span>
                                <h2 class="display-5 fw-bold mb-3">EN SEVDİĞİNİZ MARKALAR</h2>
                                <p class="lead mb-4 opacity-90">Premium kalitede ürünler, uygun fiyatlarla.</p>
                                <a asp-controller="Urun" asp-action="Index" class="btn btn-light btn-lg px-5">
                                    <i class="fas fa-crown me-2"></i>Keşfet
                                </a>
                            </div>
                            <div class="col-lg-5 text-center d-none d-lg-block">
                                <i class="fas fa-crown slider-icon text-white"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>
    </div>
</section>

<!-- Feature Boxes -->
<section class="mb-5">
    <div class="row g-3">
        <div class="col-lg-3 col-md-6">
            <div class="feature-box hover-lift">
                <div class="feature-box-icon">
                    <i class="fas fa-truck"></i>
                </div>
                <div class="feature-box-content">
                    <h6 class="mb-1">Hızlı Kargo</h6>
                    <small>Siparişiniz anında kargoda</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="feature-box hover-lift">
                <div class="feature-box-icon" style="background: var(--gradient-success);">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="feature-box-content">
                    <h6 class="mb-1">Güvenli Ödeme</h6>
                    <small>256 Bit SSL şifreleme</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="feature-box hover-lift">
                <div class="feature-box-icon" style="background: var(--gradient-warning);">
                    <i class="fas fa-undo"></i>
                </div>
                <div class="feature-box-content">
                    <h6 class="mb-1">Ücretsiz İade</h6>
                    <small>14 gün içinde kolay iade</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="feature-box hover-lift">
                <div class="feature-box-icon" style="background: var(--gradient-info);">
                    <i class="fas fa-headset"></i>
                </div>
                <div class="feature-box-content">
                    <h6 class="mb-1">7/24 Destek</h6>
                    <small>Her zaman yanınızdayız</small>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Featured Products -->
@if (Model != null && Model.Any())
{
    <section class="mb-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h2 class="mb-1">
                    <span class="gradient-text">Öne Çıkan</span> Ürünler
                </h2>
                <p class="text-muted mb-0">En popüler ve çok satan ürünlerimiz</p>
            </div>
            <a asp-controller="Urun" asp-action="Index" class="btn btn-outline-primary">
                Tümünü Gör <i class="fas fa-arrow-right ms-2"></i>
            </a>
        </div>
        
        <div class="row g-4">
            @foreach (var urun in Model)
            {
                <div class="col-xl-3 col-lg-4 col-md-6">
                    <div class="card product-card h-100">
                        <div class="card-img-wrapper position-relative overflow-hidden">
                            <img src="@(string.IsNullOrEmpty(urun.ResimUrl) ? "/images/no-image.jpg" : urun.ResimUrl)" 
                                 class="card-img-top" alt="@urun.Ad">
                            
                            <!-- Badges -->
                            @if (urun.IndirimliFiyat.HasValue)
                            {
                                <span class="product-badge">
                                    <span class="discount-badge">
                                        <i class="fas fa-bolt me-1"></i>%@(((urun.Fiyat - urun.IndirimliFiyat.Value) / urun.Fiyat * 100).ToString("F0"))
                                    </span>
                                </span>
                            }
                            
                            <!-- Favorite Button -->
                            @if (Context.Session.GetString("UserId") != null)
                            {
                                <button class="product-favorite" data-product-id="@urun.Id" title="Favorilere Ekle">
                                    <i class="far fa-heart"></i>
                                </button>
                            }
                            
                            <!-- Quick Actions Overlay -->
                            <div class="product-overlay">
                                <div class="d-flex gap-2">
                                    <a asp-controller="Urun" asp-action="Details" asp-route-id="@urun.Id" 
                                       class="btn btn-light btn-sm">
                                        <i class="fas fa-eye"></i>
                                    </a>
                                    @if (urun.Stok > 0)
                                    {
                                        <button class="btn btn-primary btn-sm add-to-cart" data-product-id="@urun.Id">
                                            <i class="fas fa-cart-plus"></i>
                                        </button>
                                    }
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-body d-flex flex-column">
                            <h6 class="card-title mb-2">@urun.Ad</h6>
                            <p class="card-text small flex-grow-1">
                                @(urun.Aciklama?.Length > 60 ? urun.Aciklama.Substring(0, 60) + "..." : urun.Aciklama)
                            </p>
                            
                            <!-- Rating -->
                            <div class="rating mb-2">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                                <span class="rating-count">(128)</span>
                            </div>
                            
                            <!-- Price -->
                            <div class="d-flex justify-content-between align-items-end">
                                <div>
                                    @if (urun.IndirimliFiyat.HasValue)
                                    {
                                        <div class="price-original">@urun.Fiyat.ToString("C")</div>
                                        <div class="price-current">@urun.IndirimliFiyat.Value.ToString("C")</div>
                                    }
                                    else
                                    {
                                        <div class="price-current" style="background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                                            @urun.Fiyat.ToString("C")
                                        </div>
                                    }
                                </div>
                                
                                <!-- Stock Status -->
                                @if (urun.Stok <= 0)
                                {
                                    <span class="stock-badge out-of-stock">
                                        <i class="fas fa-times-circle"></i> Tükendi
                                    </span>
                                }
                                else if (urun.Stok < 10)
                                {
                                    <span class="stock-badge low-stock">
                                        <i class="fas fa-exclamation-triangle"></i> Son @urun.Stok
                                    </span>
                                }
                            </div>
                        </div>
                        
                        <div class="card-footer bg-transparent border-0 pt-0">
                            <div class="d-grid gap-2">
                                @if (urun.Stok > 0)
                                {
                                    <button class="btn btn-primary add-to-cart" data-product-id="@urun.Id">
                                        <i class="fas fa-cart-plus me-2"></i>Sepete Ekle
                                    </button>
                                }
                                else
                                {
                                    <button class="btn btn-secondary" disabled>
                                        <i class="fas fa-bell me-2"></i>Stokta Yok
                                    </button>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </section>
}
else
{
    <section class="mb-5">
        <div class="empty-state">
            <i class="fas fa-box-open empty-state-icon"></i>
            <h3 class="empty-state-title">Henüz ürün bulunmuyor</h3>
            <p class="empty-state-text">Yakında premium ürünlerle karşınızda olacağız!</p>
            <a asp-controller="Admin" asp-action="Products" class="btn btn-primary">
                <i class="fas fa-plus me-2"></i>Ürün Ekle
            </a>
        </div>
    </section>
}

<!-- Newsletter Section -->
<section class="mb-4">
    <div class="card" style="background: var(--gradient-primary); border: none;">
        <div class="card-body py-5">
            <div class="row align-items-center">
                <div class="col-lg-6 text-white mb-4 mb-lg-0">
                    <h3 class="fw-bold mb-2">
                        <i class="fas fa-envelope-open-text me-2"></i>Bültenimize Abone Olun
                    </h3>
                    <p class="mb-0 opacity-90">Kampanyalardan ve yeni ürünlerden ilk siz haberdar olun!</p>
                </div>
                <div class="col-lg-6">
                    <form class="d-flex gap-2">
                        <input type="email" class="form-control form-control-lg" placeholder="E-posta adresiniz" 
                               style="border-radius: var(--radius-full);">
                        <button type="submit" class="btn btn-light btn-lg px-4" style="border-radius: var(--radius-full);">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        // Category Scroller
        function scrollCategories(direction) {
            const scroller = document.getElementById('categoryScroller');
            const scrollAmount = 300;
            scroller.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
        }
        
        $(document).ready(function() {
            // Add to Cart
            $('.add-to-cart').click(function(e) {
                e.preventDefault();
                e.stopPropagation();
                var productId = $(this).data('product-id');
                var btn = $(this);
                
                btn.prop('disabled', true).html('<i class="fas fa-spinner fa-spin"></i>');
                
                addToCart(productId);
                
                setTimeout(function() {
                    btn.prop('disabled', false).html('<i class="fas fa-cart-plus me-2"></i>Sepete Ekle');
                }, 1000);
            });

            // Favorite Toggle
            $('.product-favorite').click(function(e) {
                e.preventDefault();
                e.stopPropagation();
                var button = $(this);
                var productId = button.data('product-id');
                var icon = button.find('i');
                var isFavorite = icon.hasClass('fas');
                
                var url = isFavorite ? '@Url.Action("RemoveFromFavorites", "Account")' : '@Url.Action("AddToFavorites", "Account")';
                
                $.post(url, { urunId: productId }, function(data) {
                    if (data.success) {
                        if (isFavorite) {
                            icon.removeClass('fas').addClass('far');
                            button.removeClass('active');
                        } else {
                            icon.removeClass('far').addClass('fas');
                            button.addClass('active');
                        }
                        showToast('Başarılı!', data.message, 'success');
                    } else {
                        showToast('Hata!', data.message, 'error');
                    }
                }).fail(function() {
                    showToast('Hata!', 'Bir hata oluştu!', 'error');
                });
            });
        });
    </script>
}
